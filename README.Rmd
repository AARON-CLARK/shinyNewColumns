---
output: github_document
---

<!-- README.md is generated from README.Rmd. Please edit that file -->

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>",
  fig.path = "man/figures/",
  out.width = "100%"
)
```

# shinyNewColumns <a href='https://github.com/AARON-CLARK/shinyNewColumns'><img src="man/figures/hex-shinyNewColumns.png" align="right" height="170"/></a>

<!-- badges: start -->

[![Lifecycle: experimental](https://img.shields.io/badge/lifecycle-experimental-orange.svg)](https://lifecycle.r-lib.org/articles/stages.html#experimental)

<!-- badges: end -->

`shinyNewColumns` is a shiny module used to derive custom columns in R data.frames on the fly. The module simply produces one small UI element: an action button titled 'Create New Column' that can be placed anywhere in an existing shiny application. Upon clicking, a modal containing a user-friendly interface will launch & allow the user to build a new column off an existing data source. Specifically, the user will be able to define a new column name, type, & label using reference column(s) as a basis to populate it's values. Along the way, the module provides simple summaries & visuals of existing column's distributions. When satisfied, the user can click 'Add variable' and the module returns the user supplied data.frame with the new column appended PLUS the `dplyr::mutate()` expressions used to generate it.

Click the `DEMO APPP` button below to launch an example app which leverages the `shinyNewColumns` module to create new columns in the popular `iris` data.frame. The app's code is provided below as well. What are you waiting for? Go empower your users to make some columns!

<center>
<a href="https://bit.ly/shinynewcolumns">
<img src="man/figures/bttn_og_refresh_darkgrey.png" alt="Demo shinyNewColumns example app" width="15%">
</a>
</center>

## Shiny Conf 2022

The `shinyNewColumns` shiny module was presented as a featured tutorial for the first annual Appsilon Shiny Conference in April of 2022. The subject of the tutorial was on "**Evaluating user inputs from dynamically produced UI modules**". With time, Appsilon will post the tutorial's recording to their [YouTube](https://www.youtube.com/channel/UC6LqpR5qBfNlQp5mVIVsthA) channel. In the meantime, feel free to checkout the presentation slide deck [here](https://github.com/AARON-CLARK/shinyNewColumns/tree/master/inst/example/shinyconf%20tutorial). Enjoy and please feel free to reach out with any questions by [submitting an issue](https://github.com/AARON-CLARK/shinyNewColumns/issues) to the repo.

## Purpose

Imagine everyone's worse nightmare - users interacting with vital data sources used on the back-end of your application. Why create a module that allows users to change data? Won't they screw it up? Well, first of all, the data doesn't 'get changed'! When using `shinyNewColumns`, users are only allowed to **append** new columns to an existing data source, preserving the original data. Believe it or not, there **are** in fact use cases when creating new columns could help solve a lot of problems & paint points. Putting this (super)power into the hands of users can actually free up the data owner's time (which can sometimes be the users themselves or sometimes developers), so why not?

## Scope

There are already a lot of R packages out there for editing data (such as `rhandsontable` or `editData`), so `shinyNewColumns` seeks to fill a small void in the niche that is deriving new data.

## Installation

You can install the current development version of `shinyNewColumns` from [GitHub](https://github.com/AARON-CLARK/shinyNewColumns) using:

```{r, eval = FALSE}
remotes::install_github("AARON-CLARK/shinyNewColumns")
```

## Example App

This is a basic example which shows you how to integrate the `shinyNewColumns` module into a shiny app. On the UI side, you just need to decide where to place the a `Add New Column` button. The server-side logic only needs a data.frame to manipulate. The return value, `out` will contain the same data, with new column(s) appended and the `dplyr::mutate()` code used to generate it. 

```{r example, eval = FALSE}
library(shinyNewColumns)
library(shiny)
library(DT)

ui <- fluidPage(
    h1("shinyNewColumns" , align = "center"),
    br(), br(),
    # just a button...
    fluidRow(column(12, align = "center", mod_launchModal_ui("snc"))),
    br(),
    h3("New column's code:"),
    h4("(generated by user inputs)"),
    verbatimTextOutput("display_expr"),
    br(),
    h3("Iris data:"),
    wellPanel(dataTableOutput("display_data"))
)

server <- function(input, output) {
  out <- mod_launchModal_srv("snc", dat = iris)
  output$display_expr <- renderPrint(out$expr())
  output$display_data <- renderDataTable(out$data())
}

shinyApp(ui = ui, server = server)
```

#### Test drive now

The example app code (above) has been deployed on shinyapps.io for your convenience. Please click on the button below to get started exploring `shinyNewColumns`:

<center>
<a href="https://bit.ly/shinynewcolumns">
<img src="man/figures/bttn_og_refresh_darkgrey.png" alt="Demo shinyNewColumns example app" width="15%">
</a>
</center>


#### Visuals please!

Here is how the UI of the `app.R` code above renders. Notice the only only component of `shinyNewColumns` seen below is the action button lablled `Add New Column`:

<br>

```{r, echo=FALSE, out.width="85%", fig.align='center'}
knitr::include_graphics("man/figures/app_screenshot.PNG")
```

<br>

Upon clicking the button, a modal will launch where the user is prompted to provide information about the the new column's derivation! When done specifying your inputs, click `Add Variable` and presto! You just built a new column.

<br>

```{r, echo=FALSE, out.width="85%", fig.align='center'}
knitr::include_graphics("man/figures/modal_range_screenshot.PNG")
```


<br>


## `shinyNewColumns` Internals

This section is really for developers looking to contribute to `shinyNewColumns`.


<br>
